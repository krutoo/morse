{"version":3,"sources":["../src/utils.js","../src/messages.js","../src/helpers/queue.js","../src/constants.js","../src/cqrs/index.js","../src/global/bus.js","../src/helpers/string-set.js","../src/channel.js","../src/index.js","utils.js","../node_modules/lodash/_baseRandom.js","../node_modules/lodash/_arraySample.js","../node_modules/lodash/_arrayMap.js","../node_modules/lodash/_baseValues.js","../node_modules/lodash/_baseTimes.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/stubFalse.js","../node_modules/lodash/isBuffer.js","../node_modules/lodash/_isIndex.js","../node_modules/lodash/isLength.js","../node_modules/lodash/_baseIsTypedArray.js","../node_modules/lodash/_baseUnary.js","../node_modules/lodash/_nodeUtil.js","../node_modules/lodash/isTypedArray.js","../node_modules/lodash/_arrayLikeKeys.js","../node_modules/lodash/_isPrototype.js","../node_modules/lodash/_overArg.js","../node_modules/lodash/_nativeKeys.js","../node_modules/lodash/_baseKeys.js","../node_modules/lodash/isObject.js","../node_modules/lodash/isFunction.js","../node_modules/lodash/isArrayLike.js","../node_modules/lodash/keys.js","../node_modules/lodash/values.js","../node_modules/lodash/_baseSample.js","../node_modules/lodash/sample.js","constants.js","microservices/status-generator.js"],"names":["isFunction","value","isString","isObject","Object","generateId","Math","random","toString","slice","Validator","checker","makeErrorText","Error","Message","topic","validateTopic","createMessage","payload","isTopic","length","isMessage","Queue","validate","stubTrue","middleware","items","listeners","queue","getSize","getItem","index","enqueue","newSize","push","forEach","listener","subscribe","MessageQueue","options","GLOBAL_BUS_KEY","Query","topicBase","queryTopic","responseTopic","createQuery","timeout","meta","isQuery","responseOf","queryMessage","recipient","author","isResponse","queryId","queueMiddleware","next","hasResponse","message","setTimeout","error","window","GlobalBus","StringSet","strings","data","reduce","setTrue","has","source","propKey","Channel","send","take","needMissed","SENT_TOPICS","mapTopics","RECEIVED_TOPICS","id","isSuitableMessage","messageHandlers","queuePosition","copyMessages","newMessage","actualHandlers","splice","handle","Validate","markAsOwn","console","handler","takeCallback","list","map","filter","sourceQueue","targetQueue","startPosition","i","missedMessage","delay","Promise","resolve","Messages","chatMessage","statusQuery","PHRASES","STATUSES","addEventListener","channel","watch","then","handleMessage"],"mappings":"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","file":"status-generator.b6bfa0e7.js","sourceRoot":"../example","sourcesContent":["export const isFunction = value => typeof value === 'function';\n\nexport const isString = value => typeof value === 'string';\n\nexport const isObject = value => Object(value) === value;\n\nexport const generateId = () => Math.random().toString(16).slice(2);\n\nexport const Validator = (checker, makeErrorText) => value => {\n  if (!checker(value)) {\n    throw Error(makeErrorText(value));\n  }\n};\n","import { Validator, isString, isObject } from './utils';\n\n/*\n * Creates a new factory of messages.\n */\nconst Message = topic => {\n  validateTopic(topic);\n\n  const createMessage = payload => ({ topic, payload });\n\n  createMessage.topic = topic;\n\n  return createMessage;\n};\n\nconst isTopic = value => isString(value) && value.length > 0;\n\nconst isMessage = value => isObject(value) && isTopic(value.topic);\n\nconst validateTopic = Validator(\n  isTopic,\n  () => 'Message topic must be a non empty string'\n);\n\nexport { Message, isTopic, isMessage };\n","import { isFunction, Validator } from '../utils';\nimport { isMessage } from '../messages';\n\nexport const Queue = ({ validate = stubTrue, middleware } = {}) => {\n  const items = [];\n  const listeners = [];\n\n  const queue = {\n    getSize: () => items.length,\n    getItem: index => items[index],\n    enqueue: value => {\n      validate(value);\n\n      const newSize = items.push(value);\n\n      listeners.forEach(listener => listener(value));\n\n      return newSize;\n    },\n    subscribe: listener => {\n      isFunction(listener) && listeners.push(listener);\n    },\n  };\n\n  if (middleware) {\n    queue.enqueue = middleware(queue)(queue.enqueue);\n  }\n\n  return queue;\n};\n\nconst stubTrue = () => true;\n\nexport const MessageQueue = options => Queue({\n  ...options,\n  validate: Validator(\n    isMessage,\n    value => `Expected a valid message to enqueue, received: ${value}`\n  ),\n});\n","export const GLOBAL_BUS_KEY = '__MORSE_GLOBALS__';\n","/*\n * Query() creates new factory of query-messages (like createAction() from redux-toolkit).\n * Query-message is message which can be answered.\n */\nconst Query = topicBase => {\n  const queryTopic = `[@@query]${topicBase}`;\n  const responseTopic = `[@@response]${topicBase}`;\n\n  const createQuery = (payload, { timeout = 10000 } = {}) => ({\n    topic: queryTopic,\n    payload,\n    meta: { isQuery: true, timeout, responseTopic },\n  });\n\n  createQuery.queryTopic = queryTopic;\n  createQuery.responseTopic = responseTopic;\n\n  return createQuery;\n};\n\n// @todo add checking of \"isQuery\" meta property\nQuery.responseOf = (queryMessage, payload) => ({\n  topic: queryMessage.meta.responseTopic,\n  payload,\n  meta: {\n    recipient: queryMessage.meta.author,\n    isResponse: true,\n    queryId: queryMessage.meta.queryId,\n  },\n});\n\n/*\n * Middleware for global message queue.\n */\nconst queueMiddleware = queue => next => {\n  const hasResponse = {};\n\n  return message => {\n    if (message.meta?.isQuery) {\n      const queryId = queue.getSize();\n\n      hasResponse[queryId] = false;\n\n      setTimeout(() => {\n        if (!hasResponse[queryId]) {\n          hasResponse[queryId] = true;\n\n          next({\n            topic: message.meta?.responseTopic,\n            payload: Error('Query cancelled by timeout'),\n            meta: { recipient: message.meta?.author, isResponse: true },\n            error: true,\n          });\n        }\n      }, message.meta?.timeout);\n\n      next({ ...message, meta: { ...message.meta, queryId } });\n    } else if (message.meta?.isResponse) {\n      const { queryId } = message.meta;\n\n      if (!hasResponse[queryId]) {\n        hasResponse[queryId] = true;\n        next(message);\n      }\n    } else {\n      next(message);\n    }\n  };\n};\n\nexport { Query, queueMiddleware };\n","import { MessageQueue } from '../helpers/queue';\nimport { GLOBAL_BUS_KEY } from '../constants';\nimport { queueMiddleware } from '../cqrs';\n\n// @todo рассмотреть вариант c window.dispatchEvent (учесть возможное использование в worker'ах)\nwindow[GLOBAL_BUS_KEY] = window[GLOBAL_BUS_KEY] || {\n  queue: MessageQueue({ middleware: queueMiddleware }),\n};\n\nexport const GlobalBus = window[GLOBAL_BUS_KEY];\n","export const StringSet = strings => {\n  const data = strings.reduce(setTrue, {});\n\n  return {\n    has: value => data[value] === true,\n  };\n};\n\nconst setTrue = (source, propKey) => {\n  source[propKey] = true;\n  return source;\n};\n","import { GlobalBus } from './global/bus';\nimport { isMessage, isTopic } from './messages';\nimport { MessageQueue } from './helpers/queue';\nimport { StringSet } from './helpers/string-set';\nimport { generateId, isFunction, Validator } from './utils';\n\n// @todo хранить статусы вопросов и отвечать шине о статусе по необходимости?\n\n/*\n * Creates a new channel for sending/receiving messages.\n */\nexport const Channel = ({ send = [], take = [], needMissed = true } = {}) => {\n  const SENT_TOPICS = StringSet(mapTopics(send));\n  const RECEIVED_TOPICS = StringSet(mapTopics(take));\n\n  const id = generateId();\n\n  const markAsOwn = message => ({ ...message, meta: { ...message.meta, author: id } });\n\n  const isSuitableMessage = message => {\n    const { author, recipient } = message.meta || {};\n\n    return RECEIVED_TOPICS.has(message.topic)\n      && author !== id\n      && (!recipient || recipient === id);\n  };\n\n  const queue = MessageQueue();\n  const messageHandlers = [];\n  let queuePosition = 0;\n\n  needMissed && copyMessages(GlobalBus.queue, queue, isSuitableMessage);\n\n  GlobalBus.queue.subscribe(newMessage => {\n    isSuitableMessage(newMessage) && queue.enqueue(newMessage);\n  });\n\n  queue.subscribe(newMessage => {\n    // moving handlers to copied list for prevent loops \"take, handle, take...\"\n    const actualHandlers = messageHandlers.splice(0, messageHandlers.length);\n\n    actualHandlers.length && queuePosition < queue.getSize() && queuePosition++;\n\n    for (const handle of actualHandlers) handle(newMessage);\n  });\n\n  return {\n    send: message => {\n      Validate.message(message);\n\n      if (SENT_TOPICS.has(message.topic)) {\n        GlobalBus.queue.enqueue(markAsOwn(message));\n      } else {\n        console.error(`Topic \"${message.topic}\" is not specified as sent`);\n      }\n    },\n    take: handler => {\n      Validate.takeCallback(handler);\n\n      if (queuePosition < queue.getSize()) {\n        handler(queue.getItem(queuePosition++));\n      } else {\n        messageHandlers.push(handler);\n      }\n    },\n  };\n};\n\nconst mapTopics = list => list.map(value => value?.topic || value).filter(isTopic);\n\nconst copyMessages = (sourceQueue, targetQueue, isSuitableMessage) => {\n  const startPosition = sourceQueue.getSize();\n\n  for (let i = 0; i < startPosition; i++) {\n    const missedMessage = sourceQueue.getItem(i);\n\n    isSuitableMessage(missedMessage) && targetQueue.enqueue(missedMessage);\n  }\n};\n\nconst Validate = {\n  takeCallback: Validator(\n    isFunction,\n    value => `Expected a function, received: ${value}`\n  ),\n  message: Validator(\n    isMessage,\n    value => `Expected valid message, received: ${value}`\n  ),\n};\n","import { Message } from './messages';\nimport { Channel } from './channel';\n\nexport { Channel, Message };\n","export const delay = timeout => new Promise(resolve => setTimeout(resolve, timeout));\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeFloor = Math.floor,\n    nativeRandom = Math.random;\n\n/**\n * The base implementation of `_.random` without support for returning\n * floating-point numbers.\n *\n * @private\n * @param {number} lower The lower bound.\n * @param {number} upper The upper bound.\n * @returns {number} Returns the random number.\n */\nfunction baseRandom(lower, upper) {\n  return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n}\n\nmodule.exports = baseRandom;\n","var baseRandom = require('./_baseRandom');\n\n/**\n * A specialized version of `_.sample` for arrays.\n *\n * @private\n * @param {Array} array The array to sample.\n * @returns {*} Returns the random element.\n */\nfunction arraySample(array) {\n  var length = array.length;\n  return length ? array[baseRandom(0, length - 1)] : undefined;\n}\n\nmodule.exports = arraySample;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var arraySample = require('./_arraySample'),\n    values = require('./values');\n\n/**\n * The base implementation of `_.sample`.\n *\n * @private\n * @param {Array|Object} collection The collection to sample.\n * @returns {*} Returns the random element.\n */\nfunction baseSample(collection) {\n  return arraySample(values(collection));\n}\n\nmodule.exports = baseSample;\n","var arraySample = require('./_arraySample'),\n    baseSample = require('./_baseSample'),\n    isArray = require('./isArray');\n\n/**\n * Gets a random element from `collection`.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to sample.\n * @returns {*} Returns the random element.\n * @example\n *\n * _.sample([1, 2, 3, 4]);\n * // => 2\n */\nfunction sample(collection) {\n  var func = isArray(collection) ? arraySample : baseSample;\n  return func(collection);\n}\n\nmodule.exports = sample;\n","import { Message } from '../src';\nimport { Query } from '../src/cqrs';\n\n/**\n * Message factories for communication between microservices.\n */\nexport const Messages = {\n  chatMessage: Message('CHAT_MESSAGE'),\n  statusQuery: Query('STATUS'),\n};\n\nexport const PHRASES = [\n  'How do you do!',\n  'I\\'m bored',\n  'Is it a your real name?',\n  'AFK',\n  'I am here =)',\n  'idk',\n  'do you like pizza?',\n  'Miss you',\n];\n\nexport const STATUSES = [\n  'Your ad could be here...',\n  'This is my new status!',\n  '=)',\n  'Avada Kedavra!',\n  'Away',\n  'Active',\n  'At home',\n];\n","import { Channel } from '../../src/index'; // aka 'morse'\nimport { Query } from '../../src/cqrs';\nimport { delay } from '../utils';\nimport sample from 'lodash/sample';\nimport { STATUSES, Messages } from '../constants';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  // creating channel\n  const channel = Channel({\n    take: [Messages.statusQuery.queryTopic],\n    send: [Messages.statusQuery.responseTopic],\n  });\n\n  const handleMessage = message => {\n    if (message.topic === Messages.statusQuery.queryTopic) {\n      delay(2000).then(() => {\n        channel.send(Query.responseOf(message, sample(STATUSES)));\n      });\n    }\n  };\n\n  // handle message and immediately start waiting next\n  const watch = message => {\n    handleMessage(message);\n    channel.take(watch);\n  };\n\n  // start watching\n  channel.take(watch);\n});\n"]}